<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>TemporalQA Annotations</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
      #wikipedia-pane {
          height: 600px;
          padding-top: 0px;
          padding-right: 0px;
          padding-bottom: 0px;
          padding-left: 0px;
          overflow: auto;
      }
      
      #loading-pane {
          background-color: #EBDEF0;
          height: 600px;
          overflow: auto;
          padding-top: 0px;
          padding-right: 15px;
          padding-bottom: 0px;
          padding-left: 15px;
      }

      #results-pane {
          background-color: #EBDEF0;
          height: 600px;
          overflow: auto;
          padding-top: 0px;
          padding-right: 15px;
          padding-bottom: 0px;
          padding-left: 15px;
      }

      #searchResultsVis span {
          cursor: pointer;
          color: blue;
          text-decoration: underline;
      }
      #searchResultsVis span:hover {
          text-decoration: none;
      }
      #searchResultsVis p {
          padding-left: 25px;
      }

      #instructions-pane {
          background-color: #EBDEF0;
          height: 600px;
          overflow: auto;
          padding-top: 0px;
          padding-right: 15px;
          padding-bottom: 0px;
          padding-left: 15px;
      }
      
      #left-pane {
          background-color: #EEEEEE;
          height: 650px;
          overflow: auto;
          padding-top: 0px;
          padding-right: 0px;
          padding-bottom: 0px;
          padding-left: 0px;
      }

      #right-pane {
          background-color: #EEEEEE;
          height: 650px;
          overflow: auto;
      }

      #navbar {
          height: 50px;
      }
      
      hr {
          height: 1px;
          background-color: #ccc;
          border: none;
      }
    </style>
  </head>

  <body>
    <div role="main" class="container-fluid">
      <div class="row">
        <div class="col-8" id="left-pane">
          <nav id="navbar" class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="my-2 d-inline w-100">
              <div class="input-group">
                <input id="searchInput" type="text" class="form-control" placeholder="Search" autocomplete="off">
                <span class="input-group-append">
                  <button id="newSearchBtn" class="btn btn-success" type="button">New Search</button>
                  <button id="viewResultsBtn" class="btn text-nowrap btn-primary">Toggle Search Results</button>
                  <button id="viewInstructionsBtn" class="btn text-nowrap btn-danger">Toggle Instructions</button>
                </span>
              </div>
            </div>
          </nav>
          <div id="instructions-pane">
            <br/>
            <h1>Instructions:</h1>
            <div class="my-3 pl-5">
              <ul>
                <li>
                  Help us make search systems (i.e. Google) smarter by teaching them to identify past and present answers to your questions!
                </li>
                <li>
                  In this task, you will be have to <b>determine what the current and previous answers</b> to the question are and <b>when they started to apply</b>. 
                </li>
                <li>
                  Read through these instructions and examples below to get started!
                </li>
              </ul>
              <h5>Steps:</h5>
              <ol>
                <li class="my-2">
                  <b>Read the question on the right.</b>
                  <ul>
                    <li>If the answer to the question is a <b>list</b>, then select the checkbox indicating so.</li>
                    <ul>
                      <li>The answer to <i>"Who are all the billionaires in the US?"</i> <b>is</b> a list.</li>
                      <li>The answer to <i>"How many billionaires are in the US?"</i> <b>is not</b> a list.</li>
                      <li>More details on how to respond to these questions are in <i>Step 4</i> and <i>Example 3</i> below.</li>
                    </ul>
                  </ul>
                </li>
                <li class="my-2">
                  <b>Enter your google search query</b> in the bar above to find the answer to the question.
                    <ul>
                    <li>Click the "New Search" button to enter your search.</li>
                    <li>We will then show you Google's top suggested Wikipedia articles for your query.</li>
                    </ul>
                </li>
                <li class="my-2">
                  <b>Select the article</b> containing the <b>current and previous answers</b> to the question.
                  <ul>
                    <li>
                      You will probably have to cycle though multiple ariticles to find one with the necessary information.
                    </li>
                    <li>
                      Use the toolbar above to return to your search results or enter a new search.
                    </li>
                    <li>
                      <b>If you cannot find an article containing current answer</b> after going through <b>at least 3 articles</b>, move on to the next step.
                    </li>
                  </ul>
                </li>
                <li class="my-2">
                  <b>Copy from the article fill out the form on the right.</b>
                  <ul>
                    <li>
                      If you can't find the necessary information to fill out a field, click the "Missing" button mark it.
                    </li>
                    <li>
                      <b>When entering a date</b>, make sure it contains the year (ex. "1997" or "2021")
                    </li>
                    <li>
                      <b>If you marked that the answer is a list</b>, just give the most recent example as the answer. See <i>Example 3</i> below.
                    </li>
                  </ul>
                </li>
                <li class="my-2">
                  <b>Submit</b> the HIT by clicking the button at the bottom form to the right.
                </li>
              </ol>
            </div>
            <hr/>
            <h3>Example 1:</h3>
            <div>
              <div class="row">
                <div class="col-1">
                </div>
                <div class="alert col-6 text-dark" style="background-color: #EEEEEE">
                  <fieldset disabled>
                    <div class="alert my-2">
                      <h3>Question:</h3>
                      <p class="text-center"><b><i>What city is the next winter olympics in?</i></b></p>
                    </div>
                    <label class="mr-sm-2">Select an article</label>
                    <input class="form-control" placeholder="Olympic Games" disabled="true">
                    <div class="form-check my-2 pl-4">
                      <input class="form-check-input pl-4" type="checkbox">
                      <label class="form-check-label">
                        The answer to this question is a list.
                      </label>
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label>
                        Copy the <b>current</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="curAnswer" class="form-control form-field" placeholder="Beijing">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>current</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2018">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label class="my-2">
                        Copy the <b>previous</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="prevAnswer" class="form-control form-field" placeholder="PyeongChang">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>previous</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2014">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                  </fieldset>
                </div>
                <div class="alert col-5 text-dark">
                  <div class="alert my-2">
                    <h3>Explanation:</h3>
                  </div>
                  <p class="pl-5">
                    The olympics are held in a different city every 4 years. The next winter olympics in 2022 will be held at <b>Beijing</b>. Therefore, Beijing became the site of the next winter olympics in <b>2018</b>, following the previous winter olympics which were held in <b>PyeongChang</b>. <b>PyeongChang</b> became the site of the <i>"next"</i> winter olympics following the olympics before that in <b>2014</b>.
                  </p>
                </div>
              </div>
            </div>
            <hr/>
            <h3>Example 2:</h3>
            <div>
              <div class="row">
                <div class="col-1">
                </div>
                <div class="alert col-6 text-dark" style="background-color: #EEEEEE">
                  <fieldset disabled>
                    <div class="alert my-2">
                      <h3>Question:</h3>
                      <p class="text-center"><b><i>Who does Tom Brady play for?</i></b></p>
                    </div>
                    <label class="mr-sm-2">Select an article</label>
                    <input class="form-control" placeholder="Tom Brady" disabled="true">
                    <div class="form-check my-2 pl-4">
                      <input class="form-check-input pl-4" type="checkbox" value="">
                      <label class="form-check-label">
                        The answer to this question is a list.
                      </label>
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label>
                        Copy the <b>current</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="curAnswer" class="form-control form-field" placeholder="Tampa Bay Buccaneers">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>current</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2020">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label class="my-2">
                        Copy the <b>previous</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="prevAnswer" class="form-control form-field" placeholder="New England Patriots">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>previous</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2000">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                  </fieldset>
                </div>
                <div class="alert col-5 text-dark">
                  <div class="alert my-2">
                    <h3>Explanation:</h3>
                  </div>
                  <p class="pl-5">
                    Tom Brady, an American football player, currently plays for the <b>Tampa Bay Buccaneers</b> who he signed with in <b>2020</b>. Before that, he played for the <b>New England Patriots</b> since <b>2000</b>.
                  </p>
                </div>
              </div>
            </div>
            <hr/>
            <h3>Example 3:</h3>
            <div>
              <div class="row">
                <div class="col-1">
                </div>
                <div class="alert col-6 text-dark" style="background-color: #EEEEEE">
                  <fieldset disabled>
                    <div class="alert my-2">
                      <h3>Question:</h3>
                      <p class="text-center"><b><i>What movies did Adam Sandler play in?</i></b></p>
                    </div>
                    <label class="mr-sm-2">Select an article</label>
                    <input class="form-control" placeholder="Adam Sandler" disabled="true">
                    <div class="form-check my-2 pl-4">
                      <input class="form-check-input pl-4" type="checkbox" value="" checked>
                      <label class="form-check-label">
                        The answer to this question is a list.
                      </label>
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label>
                        Copy the <b>current</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="curAnswer" class="form-control form-field" placeholder="Hubie Halloween">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>current</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2020">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                    <hr/>
                    <div class="form-group">
                      <label class="my-2">
                        Copy the <b>previous</b> answer to this question from the selected article
                      </label>
                      <div class="input-group">
                        <input type="prevAnswer" class="form-control form-field" placeholder="Uncut Gems">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                      <label class="my-2">
                        Copy when the <b>previous</b> answer <b>started</b> to apply from the selected article
                      </label>
                      <div class="input-group">
                        <input type="text" class="form-control form-field" placeholder="2019">
                        <span class="input-group-append">
                          <button class="btn btn-secondary form-field" type="button">Missing</button>
                        </span>
                      </div> 
                    </div>
                  </fieldset>
                </div>
                <div class="alert col-5 text-dark">
                  <div class="alert my-2">
                    <h3>Explanation:</h3>
                  </div>
                  <p class="pl-5">
                    This example has an answer that is a compounding list of movies which is added to over time. Therefore, we <b>first select the checkbox indicating so</b>, then just respond to the the current and prvious answers with his two most recent movies, respectively.
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div id="loading-pane" style="display: none;"><br/><h1>Loading...</h1></div>
          <div id="results-pane" style="display: none;">
            <br/>
            <h1>Search Results:</h1>
            <div class="alert alert-primary my-2">
              <h3>Showing Results For: <u id="searchQueryVis">Enter a new search above</u></h3>
            </div>
            <div id="searchResultsVis"> </div>
          </div>
          <iframe id="wikipedia-pane" class="container-fluid" frameBorder="0" style="display: none;"></iframe>
        </div>
        <div class="col-4" id="right-pane">
          <div class="alert alert-primary my-2">
            <h3>Question:</h3>
            <p class="text-center"><b><i>${QUESTION}</i></b></p>
          </div>
          <div id="fakeForm">
            <div class="form-group">
              <label>
                Select an article.
              </label>
              <input type="searchResultSelect" class="form-control" id="searchResultSelect" name="searchResultSelect" placeholder="Select an article" disabled="true" autocomplete="off">
              <div class="form-check my-2 pl-4">
                <input class="form-check-input pl-4" type="checkbox" value="" id="listAnswer" name="listAnswer" autocomplete="off">
                <label class="form-check-label">
                  The answer to this question is a list that changes over time.
                </label>
              </div>
            </div>
            <hr/>
            <div class="form-group">
              <label>
                Copy the <b>current</b> answer to this question from the selected article
              </label>
              <div class="input-group">
                <input type="curAnswer" class="form-control form-field" id="curAnswerInput" name="curAnswerInput" placeholder="Current Answer..." autocomplete="off">
                <span class="input-group-append">
                  <button id="curAnswerBlank" class="btn btn-secondary form-field" type="button">Missing</button>
                </span>
              </div> 
              <label class="my-2">Copy when the <b>current</b> answer <b>started</b> to apply from the selected article</label>
              <div class="input-group">
                <input type="text" id="curAnswerStartInput" name="curAnswerStartInput" class="form-control form-field" placeholder="Current Answer Start Date..." autocomplete="off">
                <span class="input-group-append">
                  <button id="curAnswerStartBlank" class="btn btn-secondary form-field" type="button">Missing</button>
                </span>
              </div> 
            </div>
            <hr/>
            <div class="form-group">
              <label class="my-2">
                Copy the <b>previous</b> answer to this question from the selected article
              </label>
              <div class="input-group">
                <input type="prevAnswer" class="form-control form-field" id="prevAnswerInput" name="prevAnswerInput" placeholder="Previous Answer..." autocomplete="off">
                <span class="input-group-append">
                  <button id="prevAnswerBlank" class="btn btn-secondary form-field" type="button">Missing</button>
                </span>
              </div> 
              <label class="my-2">
                Copy when the <b>previous</b> answer <b>started</b> to apply from the selected article
              </label>
              <div class="input-group">
                <input type="text" id="prevAnswerStartInput" name="prevAnswerStartInput" class="form-control form-field" placeholder="Previous Answer Start Date..." autocomplete="off">
                <span class="input-group-append">
                  <button id="prevAnswerStartBlank" class="btn btn-secondary form-field" type="button">Missing</button>
                </span>
              </div> 
            </div>
            <div class="alert alert-danger" id='submitErrorAlert' style="display: none;">
              <h5>Please review the instructions and make sure that:</h5>
              <ul>
                <li>All fields are either filled out or marked "Missing"</li>
                <li>The current and previous start dates contain the year (ex. "1997" or "2021")</li>
                <li>If you have searched through at least 3 articles before marking the current answer as "Missing"</li>
              </ul>
            </div>
          </div>
          <input id="queriesUsed" name="queriesUsed" type='hidden' readOnly />
          <input id="articlesUsed" name="articlesUsed" type='hidden' readOnly />
          <form id="mturkForm" name="mturk_form" method="post" autocomplete="off">
            <div class="form-group">
              <input id="assignmentId" name="assignmentId" type='hidden' readOnly />
              <input id="hitId" name="hitId" type='hidden' readOnly />
              <input id="workerId" name="workerId" type='hidden' readOnly />
              <input id="answerData" name="answerData" type='hidden' readOnly />
            </div>
          </form>
          <button class="btn btn-primary my-2" type="button" id='submitResponse'>
            Submit HIT
          </button>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
         ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


    <script async src="https://cse.google.com/cse.js?cx=7dd36d3a7fb6c51f5"></script>

    <script>
      function turkGetParam( name, defaultValue ) { 
          var regexS = "[\?&]"+name+"=([^&#]*)"; 
          var regex = new RegExp( regexS ); 
          var tmpURL = window.location.href; 
          var results = regex.exec( tmpURL ); 
          if( results == null ) { 
              return defaultValue; 
          } else { 
              return results[1];    
          } 
      }
      
      function decode(strToDecode)
      {
          var encoded = strToDecode;
          return unescape(encoded.replace(/\+/g,  " "));
      }
      
      function turkGetSubmitToHost() {
          var defaultHost = "https://www.mturk.com";
          var submitToHost = decode(turkGetParam("turkSubmitTo", defaultHost));
          if (stringStartsWith(submitToHost, "https://")) {
              return submitToHost;
          }
          if (stringStartsWith(submitToHost, "http://")) {
              return submitToHost;
          }
          if (stringStartsWith(submitToHost, "//")) {
              return submitToHost;
          }
          return defaultHost;
      }
      
      // Inlined functionality for String.startsWith as IE does not support that method.
      // Function body from:
      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith#Polyfill
      function stringStartsWith(str, search, pos) {
          pos = (!pos || pos < 0) ? 0 : +pos;
          return str.substring(pos, pos + search.length) === search;
      }

      function newSearchCallback(responseJSON) {
          $("#searchQueryVis").text(responseJSON.queries.request[0].searchTerms);
          $("#searchResultsVis").empty();
          responseJSON.items.map(ex => {
              $("#searchResultsVis").append("<span class='searchResult' href='"+ ex.link + "'>" + ex.htmlTitle + "</a>");
              $("#searchResultsVis").append("<p>" + ex.htmlSnippet + "</p>");
          });
          $("#searchResultsVis span").click(function() {
              let usedArticles = []
              if ($("#articlesUsed").val()) {
                  usedArticles = JSON.parse($("#articlesUsed").val());
              }
              usedArticles.push({"link": $(this).attr("href"), "title": $(this).text()})
              $("#articlesUsed").val(JSON.stringify(usedArticles)); 
              $("#wikipedia-pane").attr("src", $(this).attr("href"));
              $("#searchResultSelect").val($(this).text());
              $("#searchResultSelect").attr("href", $(this).attr("href"));
              $('#instructions-pane').hide();
              $('#results-pane').hide();
              $('#loading-pane').hide();
              $('#wikipedia-pane').show();
          });
          $('#instructions-pane').hide();
          $('#wikipedia-pane').hide();
          $('#loading-pane').hide();
          $('#results-pane').show();
      }

      $(document).ready(function() {
          $("#newSearchBtn").click(function() {
              let search_query = $("#searchInput").val();
              if ($("#searchQueryVis").text() == $("#searchInput").val()) {
                  $('#wikipedia-pane').hide();
                  $('#loading-pane').hide();
                  $('#instructions-pane').hide();
                  $('#results-pane').show();
              } else {
                  let usedQueries = []
                  if ($("#queriesUsed").val()) {
                      usedQueries = JSON.parse($("#queriesUsed").val());
                  }
                  usedQueries.push(search_query)
                  $("#queriesUsed").val(JSON.stringify(usedQueries)); 
                  let query_url = ("https://www.googleapis.com/customsearch/v1?"
                                   + "key=APIKEYHERE"
                                   + "cx=APIKEYHERE"
                                   + "q=" + escape(search_query));
                  $('#instructions-pane').hide();
                  $('#wikipedia-pane').hide();
                  $('#results-pane').hide();
                  $('#loading-pane').show();
                  $.getJSON(query_url, newSearchCallback);
              }
          });

          $("#viewResultsBtn").click(function() {
              if ($('#results-pane').is(":hidden") && $('#searchResultsVis').children().length > 0) {
                  $('#wikipedia-pane').hide();
                  $('#loading-pane').hide();
                  $('#instructions-pane').hide();
                  $('#results-pane').show();
              } else if ($('#wikipedia-pane')[0].src) {
                  $('#loading-pane').hide();
                  $('#results-pane').hide();
                  $('#instructions-pane').hide();
                  $('#wikipedia-pane').show();
              } else {
                  $('#loading-pane').hide();
                  $('#wikipedia-pane').hide();
                  $('#results-pane').hide();
                  $('#instructions-pane').show();
              }
          });
          $("#viewInstructionsBtn").click(function() {
              if ($('#instructions-pane').is(":hidden")) {
                  $('#wikipedia-pane').hide();
                  $('#loading-pane').hide();
                  $('#results-pane').hide();
                  $('#instructions-pane').show();
              } else if ($('#wikipedia-pane')[0].src) {
                  $('#loading-pane').hide();
                  $('#results-pane').hide();
                  $('#instructions-pane').hide();
                  $('#wikipedia-pane').show();
              } else if ($('#searchResultsVis').children().length > 0) {
                  $('#loading-pane').hide();
                  $('#wikipedia-pane').hide();
                  $('#instructions-pane').hide();
                  $('#results-pane').show();
              }
          });

          $("#curAnswerBlank").click(function() {
              if ($("#curAnswerBlank").text() == "Missing") {
                  $("#curAnswerBlank").text("Undo");
                  $("#curAnswerInput").val("<MISSING>");
                  $("#curAnswerInput").prop("disabled", true)
              } else {
                  $("#curAnswerBlank").text("Missing");
                  $("#curAnswerInput").val("");
                  $("#curAnswerInput").prop("disabled", false)
              }
          });
          $("#curAnswerStartBlank").click(function() {
              if ($("#curAnswerStartBlank").text() == "Missing") {
                  $("#curAnswerStartBlank").text("Undo");
                  $("#curAnswerStartInput").val("<MISSING>");
                  $("#curAnswerStartInput").prop("disabled", true)
              } else {
                  $("#curAnswerStartBlank").text("Missing");
                  $("#curAnswerStartInput").val("");
                  $("#curAnswerStartInput").prop("disabled", false)
              }
          });
          $("#prevAnswerBlank").click(function() {
              if ($("#prevAnswerBlank").text() == "Missing") {
                  $("#prevAnswerBlank").text("Undo");
                  $("#prevAnswerInput").val("<MISSING>");
                  $("#prevAnswerInput").prop("disabled", true)
              } else {
                  $("#prevAnswerBlank").text("Missing");
                  $("#prevAnswerInput").val("");
                  $("#prevAnswerInput").prop("disabled", false)
              }
          });
          $("#prevAnswerStartBlank").click(function() {
              if ($("#prevAnswerStartBlank").text() == "Missing") {
                  $("#prevAnswerStartBlank").text("Undo");
                  $("#prevAnswerStartInput").val("<MISSING>");
                  $("#prevAnswerStartInput").prop("disabled", true)
              } else {
                  $("#prevAnswerStartBlank").text("Missing");
                  $("#prevAnswerStartInput").val("");
                  $("#prevAnswerStartInput").prop("disabled", false)
              }
          });
          $("#submitResponse").click(function() {
              if ($("#curAnswerInput").val() == "<MISSING>" && !$("#articlesUsed").val()) {
                  $("#submitErrorAlert").show();
              } else if ($("#searchResultSelect").val() && $("#curAnswerInput").val() && $("#prevAnswerInput").val()
                         && ($("#curAnswerStartInput").val() == "<MISSING>" ||
                             $("#curAnswerStartInput").val().match(/\d{4}/) != null)
                         && ($("#prevAnswerStartInput").val() == "<MISSING>" ||
                             $("#prevAnswerStartInput").val().match(/\d{4}/) != null)
                         && $("#queriesUsed").val() && $("#articlesUsed").val()) {
                  submitHIT();
              } else {
                  $("#submitErrorAlert").show();
              }
          });
      });
      function submitHIT() {
          $("#mturkForm")[0].action = turkGetSubmitToHost() + "/mturk/externalSubmit";
          $("#assignmentId").val(turkGetParam('assignmentId', ""));
          $("#hitId").val(turkGetParam('hitId', ""));
          $("#workerId").val(turkGetParam('workerId', ""));
          let all_answer_data = {
              "article_title": $("#searchResultSelect").val() || null,
              "article_link": $("#searchResultSelect").attr("href") || null,
              "list_answer": $("#listAnswer").is(':checked'),
              "cur_answer": $("#curAnswerInput").val() || null,
              "cur_answer_start": $("#curAnswerStartInput").val() || null,
              "prev_answer": $("#prevAnswerInput").val() || null,
              "prev_answer_start": $("#prevAnswerStartInput").val() || null,
              "all_queries_used": JSON.parse($("#queriesUsed").val() || null),
              "all_articles_used": JSON.parse($("#articlesUsed").val() || null),
              'assignment_id': $("#assignmentId").val(),
              'worker_id': $("#workerId").val(),
          };
          $("#answerData").val(JSON.stringify(all_answer_data));
          $("#mturkForm").submit();
      }
      </script>
  </body>
</html>
